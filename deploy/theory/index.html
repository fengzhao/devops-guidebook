<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/devops-guidebook/umi.css" />
    <script>
      window.routerBase = "/devops-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.9
    </script>
    <title>&#x57FA;&#x672C;&#x6982;&#x8FF0;</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-route="/deploy/theory" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/devops-icon.png&#x27;)" href="/devops-guidebook//">DevOps Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><span><a href="/devops-guidebook//linux">Linux</a></span><span><a href="/devops-guidebook//server">服务器</a></span><span><a aria-current="page" class="active" href="/devops-guidebook//deploy">部署</a></span><span><a href="/devops-guidebook//code">代码管理</a></span><span><a href="/devops-guidebook//devops">DevOps</a></span><span><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></span></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/devops-icon.png&#x27;)" href="/devops-guidebook//"></a><h1>DevOps Guidebook</h1><p>DevOps 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/devops-guidebook//linux">Linux</a></li><li><a href="/devops-guidebook//server">服务器</a></li><li><a aria-current="page" class="active" href="/devops-guidebook//deploy">部署</a></li><li><a href="/devops-guidebook//code">代码管理</a></li><li><a href="/devops-guidebook//devops">DevOps</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a aria-current="page" class="active" href="/devops-guidebook//deploy/theory">部署理论</a><ul><li><a aria-current="page" class="active" href="/devops-guidebook//deploy/theory"><span>基本概述</span></a></li><li><a href="/devops-guidebook//deploy/theory/environment"><span>环境区分</span></a></li><li><a href="/devops-guidebook//deploy/theory/continuous-integration"><span>持续集成</span></a></li><li><a href="/devops-guidebook//deploy/theory/continuous-dilivery"><span>持续交付</span></a></li><li><a href="/devops-guidebook//deploy/theory/continuous-deployment"><span>持续部署</span></a></li><li><a href="/devops-guidebook//deploy/theory/blue-green-deployment"><span>蓝绿部署</span></a></li><li><a href="/devops-guidebook//deploy/theory/gray-release"><span>灰度部署</span></a></li><li><a href="/devops-guidebook//deploy/theory/rolling-update"><span>滚动部署</span></a></li></ul></li><li><a href="/devops-guidebook//deploy/docker">Docker</a><ul><li><a href="/devops-guidebook//deploy/docker/overview"><span>基本概述</span></a></li><li><a href="/devops-guidebook//deploy/docker/image"><span>构建镜像</span></a></li><li><a href="/devops-guidebook//deploy/docker/docker-file"><span>配置脚本</span></a></li><li><a href="/devops-guidebook//deploy/docker/container"><span>操作容器</span></a></li><li><a href="/devops-guidebook//deploy/docker/storage-patterns-for-persistence"><span>持久存储模式</span></a></li><li><a href="/devops-guidebook//deploy/docker/network"><span>网络通信</span></a></li><li><a href="/devops-guidebook//deploy/docker/operations-and-monitor"><span>运维和监控</span></a></li><li><a href="/devops-guidebook//deploy/docker/docker-compose"><span>多容器部署</span></a></li><li><a href="/devops-guidebook//deploy/docker/command"><span>常用命令</span></a></li><li><a href="/devops-guidebook//deploy/docker/extensions"><span>扩展资源</span></a></li><li><a href="/devops-guidebook//deploy/docker/mongodb"><span>部署 MongoDB</span></a></li></ul></li><li><a href="/devops-guidebook//deploy/github-actions">Github-actions</a><ul><li><a href="/devops-guidebook//deploy/github-actions"><span>Github Actions</span></a></li></ul></li><li><a href="/devops-guidebook//deploy/jenkins">Jenkins</a></li><li><a href="/devops-guidebook//deploy/rancher">Rancher</a></li></ul></div></div><ul role="slug-list" class="__dumi-default-layout-toc"></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="基本概述"><a aria-hidden="true" tabindex="-1" href="/devops-guidebook//deploy/theory#基本概述"><span class="icon,icon-link"></span></a>基本概述</h1><ul><li>部署方案规划</li><li>待部署项目分析</li><li>选购及备案域名</li><li>厂商对比与选配阿里云服务器</li><li>初步 SSH 无密码登录连接和配置</li><li>搭建 Nodejs/MongoDB/Nginx 环境</li><li>配置 IPTables/Fail2Ban 防火墙及主动防御</li><li>域名 DNS 转移及 A 记录/CNAME 解析配置</li><li>MongoDB 角色配置与安全规则设置</li><li>线上 MongoDB 单表单库导入导出与跨机迁移备份上传</li><li>PM2 发布环境配置</li><li>服务器与 Git 仓库读写配置</li><li>PM2 一键部署线上 Nodejs 项目</li><li>电影网站/ReactNative App 后台/微信公众号/微信小程序后台等项目实战部署</li><li>SSL 证书申请及 Nginx 证书集成提供 HTTPS 协议</li><li>上线方案复盘总结</li></ul><p>环境搭建</p><p>安全防护</p><p>服务环境部署</p><p>应用端口映射</p><p>数据配置部署</p><p>证书安装</p><p>项目部署与进程守护</p><ul><li>项目介绍<ul><li>部署方案</li><li>待部署项目介绍</li></ul></li><li>准备工作<ul><li>域名选购备案</li><li>厂商对比与服务器选配</li></ul></li><li>服务器<ul><li>SSH 无密码登录连接</li><li>NodeJS/MongoDB/Nginx 环境</li><li>IPTables/Fail2Ban 防火墙及主动防御</li><li>MongoDB 角色配置与安全规则</li><li>MongoDB 单表单库导入导出与跨机迁移</li><li>PM2 环境配置</li></ul></li><li>部署上线<ul><li>服务器与 Git 仓库读写配置</li><li>PM2 一键部署线上 Nodejs 项目</li><li>无数据库静态内容站点</li><li>Vue 前端静态站点</li><li>Node+MongoDB 服务端渲染的站点</li><li>React/Egg Node 服务托管前端站点</li><li>PM2 构建、编译与部署前端资源</li><li>数据库的定时备份任务配置</li></ul></li><li>收尾工作<ul><li>域名 DNS 转移及 A 记录/CNAME 解析</li><li>SSL 证书与 Nginx 证书</li><li>课程总结</li></ul></li></ul><ul><li>不同内容站点类型</li><li>无论是否有数据库</li><li>是否是 SPA 应用</li></ul><hr/><p>纯静态建议站点，只需把资源同步到服务器上即可</p><p>对于 Vue 的前端网站，部署时候需要把必要的资源编译上传号，最后把 HTML 同步到服务器上后，通过 Nginx 代理即可，我们同样给他一个域名访问。</p><p>对于 React 的前后端网站，我们可以通过 Egg 提供的服务来提供静态资源服务访问，前端资源上传可参考案例 2 中 Vue 上传图床部分。</p><p>最后，对于有数据库的站点，我们部署的时候，主要是更新代码重启服务，但需要额外把数据库相关的事件处理好，包括 SSL 证书的集成，</p><hr/><p>线上环境</p><ul><li>购买域名<ul><li>IP 地址不够友好</li><li>苹果和微信小程序不支持 IP 绑定</li><li>域名的解析是 HTTPS 比较安全</li></ul></li><li>购买服务器<ul><li>带有外网 IP 的电脑</li><li>部署 NodeJS 代码</li><li>监听 80 端口</li><li>通过 Nginx 进行端口转发到我们的 NodeJS 服务端口</li></ul></li><li>备案</li><li>服务环境配置<ul><li>用户权限和无密码登录</li><li>Nodejs 环境和必备包组件安装搭建</li><li>端口转发</li><li>HTTPS 证书的生成配置</li><li>Nginx 的安装配置</li><li>防火墙</li><li>本地数据库</li><li>自动备份机制等</li></ul></li><li>数据库配置运维</li><li>项目部署发布<ul><li>付费/免费但私密的第三方 Git 仓库平台</li><li>用户权限/密码</li><li>Nodejs 环境搭建</li><li>防火墙配置</li><li>Nginx 的安装和进行端口转发</li><li>本地数据库，线上数据库自动备份机制</li></ul></li></ul><hr/><ul><li><p>travis-ci</p></li><li><p>azure-pipelines</p></li><li><p><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/69513606">花椒前端基于 GitLab CI/CD 的自动化构建、发布实践<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/37325902">使用 Gitlab CI 实现前端资源自动发布<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/136876843">Gitlab CI 在前端 CI/CD 中的运用<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/51163261">Gitlab CI&amp;CD 实战经验分享<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/44748907">前端 Docker + Gitlab CI 的持续集成<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/94844844">部署基于 Gitlab + Docker + Rancher + Harbor 的前端项目这一篇就够了<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/38139513">从零开始搭建一个前端资源自动化构建发布系统<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li><li><p><a target="_blank" rel="noopener noreferrer" href="https://zhuanlan.zhihu.com/p/84176287">这些年的体验技术部：Node.js 基础服务 摸爬滚打才不负功名尘土<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/devops-guidebook/edit/master/docs/deploy/theory/index.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last update: ">6/20/2022 09:42:41</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/devops-guidebook/umi.js"></script>
    <script src="/devops-guidebook/docs__deploy__theory__index.md.js"></script>
  </body>
</html>
